{% load static %}
<title>JWT | Forget Password</title>
{% include 'mysite/style.html' %}
{% include 'mysite/nav.html' %}
<div class="container">
    <h1 class="mt-4 mb-3">Reset Password</h1>
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a href="{% url 'index' %}">Home</a>
        </li>
        <li class="breadcrumb-item active">Forget Password</li>
    </ol>

    <div class="row">
        <div class="col-lg-8 mb-4">
            <p class="m-b-2"><a href="{% url 'forget_password' %}">Forgotten your password?</a> Enter your email address
                below, and we'II email instructions for setting new one.</p>
            <form method="POST" id="reset-password" novalidate>
                {% csrf_token %}
                <div class="control-group form-group">
                    <div class="controls">
                        <label>Email:</label>
                        <input type="text" class="form-control" id="id_email" name="email">
                    </div>
                </div>
                <div id="success"></div>
                <button type="button" class="btn btn-primary" id="reset_password">Reset password</button>
            </form>
            <div class="m-b-2">
                <p class="font-25 font-weight-500 m-t-20 m-b-2">Instructions for password reset sent</p>
                <hr>
                <p class="m-b-2"><i class="fa fa-angle-double-right" style="font-size:22px;color:#1976D2;"></i>
                    We've emailed you instructions for setting your password, if an account exists with the email you
                    entered.
                    You should receive them shortly.
                </p>
                <p class="m-b-2"><i class="fa fa-angle-double-right" style="font-size:22px;color:#1976D2;"></i>
                    If you don't receive an email, please make sure you've entered the address you registered with,
                    and check your spam folder.
                </p>
            </div>
        </div>
    </div>
</div>
{% include 'mysite/footer.html' %}
{% include 'mysite/script.html' %}
<script class="text/javascript">
    $(document).ready(function(){
        $('#reset_password').click(function(){
            var email = $('input[name="email"]').val();
            console.log(email);
            if (email == null || email == ''){
                swal("Error","Please enter your email","error")

            }else{

                var data = {"email":email}
                $.ajax({
                  type: 'POST',
                  url: "/reset_password_link",
                  data:data,
                  success: function(result) {
                        if(result.error_code == 0){
                            swal({
                              title: 'Success!',
                              text: result.message,
                              icon: 'success'
                            }).then(function() {
                              window.location.href = '/login';
                            });
                        }else{
                           swal("Error", result.message, "error");
                        }
                  }
            });

            }
        });
    });

</script>